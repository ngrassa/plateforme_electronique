{"ast":null,"code":"var _process$env$REACT_AP, _process$env$REACT_AP2;\nconst rawBase = ((_process$env$REACT_AP = process.env.REACT_APP_API_URL) === null || _process$env$REACT_AP === void 0 ? void 0 : _process$env$REACT_AP.trim()) || ((_process$env$REACT_AP2 = process.env.REACT_APP_API_BASE_URL) === null || _process$env$REACT_AP2 === void 0 ? void 0 : _process$env$REACT_AP2.trim()) || 'http://localhost:8080';\nconst API_BASE = rawBase.replace(/\\/+$/, '').replace(/\\/api$/, '');\nconst parseJson = async response => {\n  if (!response.ok) {\n    const message = await response.text();\n    throw new Error(message || 'Erreur API');\n  }\n  return response.json();\n};\nconst getAuthHeaders = () => {\n  const token = localStorage.getItem('access_token') || localStorage.getItem('jwt_token') || '';\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n};\nexport const getInvoices = async ({\n  ownerUserId,\n  page = 0,\n  size = 10\n}) => {\n  const url = new URL(`${API_BASE}/api/invoices`);\n  url.searchParams.set('ownerUserId', ownerUserId);\n  url.searchParams.set('page', String(page));\n  url.searchParams.set('size', String(size));\n  return parseJson(await fetch(url.toString(), {\n    headers: {\n      ...getAuthHeaders()\n    }\n  }));\n};\nexport const getPayments = async () => {\n  return parseJson(await fetch(`${API_BASE}/api/payments`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  }));\n};\nexport const createInvoice = async payload => {\n  return parseJson(await fetch(`${API_BASE}/api/invoices`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(payload)\n  }));\n};","map":{"version":3,"names":["rawBase","_process$env$REACT_AP","process","env","REACT_APP_API_URL","trim","_process$env$REACT_AP2","REACT_APP_API_BASE_URL","API_BASE","replace","parseJson","response","ok","message","text","Error","json","getAuthHeaders","token","localStorage","getItem","Authorization","getInvoices","ownerUserId","page","size","url","URL","searchParams","set","String","fetch","toString","headers","getPayments","createInvoice","payload","method","body","JSON","stringify"],"sources":["/home/osboxes/plateforme_electronique/frontend/src/api/gateway.ts"],"sourcesContent":["const rawBase =\n  process.env.REACT_APP_API_URL?.trim() ||\n  process.env.REACT_APP_API_BASE_URL?.trim() ||\n  'http://localhost:8080';\nconst API_BASE = rawBase.replace(/\\/+$/, '').replace(/\\/api$/, '');\n\nexport type InvoiceStatus =\n  | 'DRAFT'\n  | 'VALIDATED'\n  | 'SENT'\n  | 'PAID'\n  | 'CANCELLED';\n\nexport type InvoiceItemPayload = {\n  description: string;\n  quantity: number;\n  unitPrice: number;\n  taxRate?: number;\n};\n\nexport type InvoicePayload = {\n  ownerUserId: string;\n  clientName: string;\n  clientEmail: string;\n  billingAddress?: string;\n  vatRate?: number;\n  issueDate?: string;\n  dueDate?: string;\n  items: InvoiceItemPayload[];\n};\n\nexport type Invoice = {\n  id: string;\n  invoiceNumber?: string;\n  clientName?: string;\n  clientEmail?: string;\n  billingAddress?: string;\n  subtotalHt?: number;\n  vatRate?: number;\n  vatAmount?: number;\n  totalTtc?: number;\n  status: InvoiceStatus;\n  issueDate?: string;\n  dueDate?: string;\n  createdAt?: string;\n};\n\nexport type InvoicePage = {\n  content: Invoice[];\n  totalElements: number;\n  totalPages: number;\n  number: number;\n  size: number;\n};\n\nexport type PaymentStatus = 'PENDING' | 'COMPLETED' | 'FAILED' | 'REFUNDED';\n\nexport type Payment = {\n  id: string;\n  reference: string;\n  invoiceId: string;\n  userId: string;\n  amount: number;\n  currency: string;\n  method: 'CARD' | 'BANK_TRANSFER' | 'CASH' | 'CHECK';\n  status: PaymentStatus;\n  paymentDate?: string;\n  createdAt?: string;\n};\n\nconst parseJson = async <T>(response: Response): Promise<T> => {\n  if (!response.ok) {\n    const message = await response.text();\n    throw new Error(message || 'Erreur API');\n  }\n  return response.json() as Promise<T>;\n};\n\nconst getAuthHeaders = (): Record<string, string> => {\n  const token =\n    localStorage.getItem('access_token') ||\n    localStorage.getItem('jwt_token') ||\n    '';\n  return token ? { Authorization: `Bearer ${token}` } : {};\n};\n\nexport const getInvoices = async ({\n  ownerUserId,\n  page = 0,\n  size = 10,\n}: {\n  ownerUserId: string;\n  page?: number;\n  size?: number;\n}): Promise<InvoicePage> => {\n  const url = new URL(`${API_BASE}/api/invoices`);\n  url.searchParams.set('ownerUserId', ownerUserId);\n  url.searchParams.set('page', String(page));\n  url.searchParams.set('size', String(size));\n  return parseJson<InvoicePage>(\n    await fetch(url.toString(), {\n      headers: {\n        ...getAuthHeaders(),\n      },\n    })\n  );\n};\n\nexport const getPayments = async (): Promise<Payment[]> => {\n  return parseJson<Payment[]>(\n    await fetch(`${API_BASE}/api/payments`, {\n      headers: {\n        ...getAuthHeaders(),\n      },\n    })\n  );\n};\n\nexport const createInvoice = async (\n  payload: InvoicePayload\n): Promise<Invoice> => {\n  return parseJson<Invoice>(\n    await fetch(`${API_BASE}/api/invoices`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n      body: JSON.stringify(payload),\n    })\n  );\n};\n"],"mappings":";AAAA,MAAMA,OAAO,GACX,EAAAC,qBAAA,GAAAC,OAAO,CAACC,GAAG,CAACC,iBAAiB,cAAAH,qBAAA,uBAA7BA,qBAAA,CAA+BI,IAAI,CAAC,CAAC,OAAAC,sBAAA,GACrCJ,OAAO,CAACC,GAAG,CAACI,sBAAsB,cAAAD,sBAAA,uBAAlCA,sBAAA,CAAoCD,IAAI,CAAC,CAAC,KAC1C,uBAAuB;AACzB,MAAMG,QAAQ,GAAGR,OAAO,CAACS,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAACA,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC;AAkElE,MAAMC,SAAS,GAAG,MAAUC,QAAkB,IAAiB;EAC7D,IAAI,CAACA,QAAQ,CAACC,EAAE,EAAE;IAChB,MAAMC,OAAO,GAAG,MAAMF,QAAQ,CAACG,IAAI,CAAC,CAAC;IACrC,MAAM,IAAIC,KAAK,CAACF,OAAO,IAAI,YAAY,CAAC;EAC1C;EACA,OAAOF,QAAQ,CAACK,IAAI,CAAC,CAAC;AACxB,CAAC;AAED,MAAMC,cAAc,GAAGA,CAAA,KAA8B;EACnD,MAAMC,KAAK,GACTC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC,IACpCD,YAAY,CAACC,OAAO,CAAC,WAAW,CAAC,IACjC,EAAE;EACJ,OAAOF,KAAK,GAAG;IAAEG,aAAa,EAAE,UAAUH,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;AAC1D,CAAC;AAED,OAAO,MAAMI,WAAW,GAAG,MAAAA,CAAO;EAChCC,WAAW;EACXC,IAAI,GAAG,CAAC;EACRC,IAAI,GAAG;AAKT,CAAC,KAA2B;EAC1B,MAAMC,GAAG,GAAG,IAAIC,GAAG,CAAC,GAAGnB,QAAQ,eAAe,CAAC;EAC/CkB,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,aAAa,EAAEN,WAAW,CAAC;EAChDG,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,MAAM,EAAEC,MAAM,CAACN,IAAI,CAAC,CAAC;EAC1CE,GAAG,CAACE,YAAY,CAACC,GAAG,CAAC,MAAM,EAAEC,MAAM,CAACL,IAAI,CAAC,CAAC;EAC1C,OAAOf,SAAS,CACd,MAAMqB,KAAK,CAACL,GAAG,CAACM,QAAQ,CAAC,CAAC,EAAE;IAC1BC,OAAO,EAAE;MACP,GAAGhB,cAAc,CAAC;IACpB;EACF,CAAC,CACH,CAAC;AACH,CAAC;AAED,OAAO,MAAMiB,WAAW,GAAG,MAAAA,CAAA,KAAgC;EACzD,OAAOxB,SAAS,CACd,MAAMqB,KAAK,CAAC,GAAGvB,QAAQ,eAAe,EAAE;IACtCyB,OAAO,EAAE;MACP,GAAGhB,cAAc,CAAC;IACpB;EACF,CAAC,CACH,CAAC;AACH,CAAC;AAED,OAAO,MAAMkB,aAAa,GAAG,MAC3BC,OAAuB,IACF;EACrB,OAAO1B,SAAS,CACd,MAAMqB,KAAK,CAAC,GAAGvB,QAAQ,eAAe,EAAE;IACtC6B,MAAM,EAAE,MAAM;IACdJ,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClC,GAAGhB,cAAc,CAAC;IACpB,CAAC;IACDqB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,OAAO;EAC9B,CAAC,CACH,CAAC;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}